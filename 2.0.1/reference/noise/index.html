
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://mustang-sz.github.io/jitkasi/2.0.1/reference/noise/">
      
      
        <link rel="prev" href="../math/">
      
      
        <link rel="next" href="../solutions/core/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>noise - jitkasi</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jitkasi.noise" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="jitkasi" class="md-header__button md-logo" aria-label="jitkasi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            jitkasi
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              noise
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="jitkasi" class="md-nav__button md-logo" aria-label="jitkasi" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    jitkasi
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mapmaking/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mapmaking
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../math/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    math
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    noise
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    noise
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise" class="md-nav__link">
    <span class="md-ellipsis">
      noise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseI" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseI.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseI.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseSmoothedSVD" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseSmoothedSVD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseSmoothedSVD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseSmoothedSVD.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseSmoothedSVD.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWhite" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseWhite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseWhite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWhite.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWhite.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWrapper" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseWrapper
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseWrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWrapper.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWrapper.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" >
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    solutions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            solutions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solutions/core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../solutions/maps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    maps
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tod/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    tod
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise" class="md-nav__link">
    <span class="md-ellipsis">
      noise
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseI" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseI.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseI.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseSmoothedSVD" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseSmoothedSVD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseSmoothedSVD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseSmoothedSVD.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseSmoothedSVD.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWhite" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseWhite
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseWhite">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWhite.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWhite.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWrapper" class="md-nav__link">
    <span class="md-ellipsis">
      NoiseWrapper
    </span>
  </a>
  
    <nav class="md-nav" aria-label="NoiseWrapper">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWrapper.apply_noise" class="md-nav__link">
    <span class="md-ellipsis">
      apply_noise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jitkasi.noise.NoiseWrapper.compute" class="md-nav__link">
    <span class="md-ellipsis">
      compute
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>noise</h1>

<div class="doc doc-object doc-module">



<a id="jitkasi.noise"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="jitkasi.noise.NoiseI" class="doc doc-heading">
            <code>NoiseI</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>A dummy noise class that does nothing.
This is the equivalent of having the noise covariance be the identity.</p>







              <details class="quote">
                <summary>Source code in <code>jitkasi/noise.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_pytree_node_class</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoiseI</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A dummy noise class that does nothing.</span>
<span class="sd">    This is the equivalent of having the noise covariance be the identity.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Just returns `dat` back to you.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The input data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The exact same thing as the input `dat`.</span>
<span class="sd">            This is not a copy.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dat</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an instance of this class.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            Unused, just here for API compatibility.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">dat</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>

    <span class="c1"># Functions for making this a pytree</span>
    <span class="c1"># Don&#39;t call this on your own</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">children</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_unflatten</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">children</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">aux_data</span>
        <span class="k">del</span> <span class="n">children</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseI.apply_noise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_noise</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Just returns <code>dat</code> back to you.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The input data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dat</code></td>            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The exact same thing as the input <code>dat</code>.
This is not a copy.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Just returns `dat` back to you.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The input data.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The exact same thing as the input `dat`.</span>
<span class="sd">        This is not a copy.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseI.compute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Initialize an instance of this class.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unused, just here for API compatibility.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize an instance of this class.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        Unused, just here for API compatibility.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">dat</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="jitkasi.noise.NoiseSmoothedSVD" class="doc doc-heading">
            <code>NoiseSmoothedSVD</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>The standard "Jon style" noise model.
Here we use the SVD to compute the noise spectrum.
This is assuming that we are operating on noise dominated data.
This class is a registered pytree so it is JITable with JAX.</p>
<p>While this model is applied in fourier space it appears to be mathematically
the same as if we computed <span class="arithmatex">\(N^{-1}\)</span> directly from the SVD and then dotted that
into the data being filtered. Math showing this (if actually true) will exist
in the docs one day...</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="jitkasi.noise.NoiseSmoothedSVD.v">v</span></code></td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The right singular vectors to of the modeled noise.
This is used to rotate any input data into the space of the noise.
This is a child of the pytree.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jitkasi.noise.NoiseSmoothedSVD.filt_spectrum">filt_spectrum</span></code></td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The inverse of the smoothed sepctrum of the noise model.
This is used as a filter to remove the modeled noise in fourier space.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>jitkasi/noise.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_pytree_node_class</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoiseSmoothedSVD</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The standard &quot;Jon style&quot; noise model.</span>
<span class="sd">    Here we use the SVD to compute the noise spectrum.</span>
<span class="sd">    This is assuming that we are operating on noise dominated data.</span>
<span class="sd">    This class is a registered pytree so it is JITable with JAX.</span>

<span class="sd">    While this model is applied in fourier space it appears to be mathematically</span>
<span class="sd">    the same as if we computed $N^{-1}$ directly from the SVD and then dotted that</span>
<span class="sd">    into the data being filtered. Math showing this (if actually true) will exist</span>
<span class="sd">    in the docs one day...</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    v : Array</span>
<span class="sd">        The right singular vectors to of the modeled noise.</span>
<span class="sd">        This is used to rotate any input data into the space of the noise.</span>
<span class="sd">        This is a child of the pytree.</span>
<span class="sd">    filt_spectrum : Array</span>
<span class="sd">        The inverse of the smoothed sepctrum of the noise model.</span>
<span class="sd">        This is used as a filter to remove the modeled noise in fourier space.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">v</span><span class="p">:</span> <span class="n">Array</span>
    <span class="n">filt_spectrum</span><span class="p">:</span> <span class="n">Array</span>

    <span class="nd">@jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the noise model.</span>
<span class="sd">        The procedure here is to rotate the data into the space of the noise,</span>
<span class="sd">        then filter out the noise in fourier space, and then rotate back.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The data to apply the noise model to.</span>
<span class="sd">            Should be 2d with `dat.shape[0] == len(self.weights)`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dat_filt : Array</span>
<span class="sd">            The data with the noise model applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dat_rot</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">dat</span><span class="p">)</span>
        <span class="n">dat_rft</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">dct_i</span><span class="p">(</span><span class="n">dat_rot</span><span class="p">)</span>
        <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">dct_i</span><span class="p">(</span>
            <span class="n">dat_rft</span><span class="o">.</span><span class="n">at</span><span class="p">[:]</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filt_spectrum</span><span class="p">[:,</span> <span class="p">:</span> <span class="n">dat_rft</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="kc">False</span>
        <span class="p">)</span>
        <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">dat_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dat_filt</span><span class="p">))</span>
        <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">dat_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.50</span><span class="p">)</span>
        <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">dat_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.50</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dat_filt</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute this noise model based on some input data.</span>
<span class="sd">        To do this we compute the SVD of the data, rotate into its sigular space,</span>
<span class="sd">        and then compute the spectrum of each rotated detector.</span>
<span class="sd">        These spectra are then smoothed and a filter a made by squaring and</span>
<span class="sd">        inverting the smoothed filter.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The data to estimate the white noise levels from.</span>
<span class="sd">            Should be a 2d array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        noise_model : NoiseSmoothedSVD</span>
<span class="sd">            An instance of NoiseSmoothedSVD with the computed noise model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">u</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">T</span>
        <span class="n">dat_rot</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dat</span><span class="p">)</span>
        <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">dct_i</span><span class="p">(</span><span class="n">dat_rot</span><span class="p">)</span>
        <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">dat_ft</span><span class="o">.</span><span class="n">at</span><span class="p">[:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">jm</span><span class="o">.</span><span class="n">gauss_smooth_1d</span><span class="p">(</span><span class="n">dat_ft</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">))</span>
        <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">dat_ft</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">dat_ft</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">dat_ft</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dat_ft</span><span class="p">)</span>

    <span class="c1"># Functions for making this a pytree</span>
    <span class="c1"># Don&#39;t call this on your own</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">children</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filt_spectrum</span><span class="p">)</span>
        <span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_unflatten</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">children</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">aux_data</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">children</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseSmoothedSVD.apply_noise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_noise</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply the noise model.
The procedure here is to rotate the data into the space of the noise,
then filter out the noise in fourier space, and then rotate back.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to apply the noise model to.
Should be 2d with <code>dat.shape[0] == len(self.weights)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dat_filt</code></td>            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data with the noise model applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the noise model.</span>
<span class="sd">    The procedure here is to rotate the data into the space of the noise,</span>
<span class="sd">    then filter out the noise in fourier space, and then rotate back.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The data to apply the noise model to.</span>
<span class="sd">        Should be 2d with `dat.shape[0] == len(self.weights)`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dat_filt : Array</span>
<span class="sd">        The data with the noise model applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dat_rot</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">dat</span><span class="p">)</span>
    <span class="n">dat_rft</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">dct_i</span><span class="p">(</span><span class="n">dat_rot</span><span class="p">)</span>
    <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">dct_i</span><span class="p">(</span>
        <span class="n">dat_rft</span><span class="o">.</span><span class="n">at</span><span class="p">[:]</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filt_spectrum</span><span class="p">[:,</span> <span class="p">:</span> <span class="n">dat_rft</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]),</span> <span class="kc">False</span>
    <span class="p">)</span>
    <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">dat_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dat_filt</span><span class="p">))</span>
    <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">dat_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.50</span><span class="p">)</span>
    <span class="n">dat_filt</span> <span class="o">=</span> <span class="n">dat_filt</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mf">0.50</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dat_filt</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseSmoothedSVD.compute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Compute this noise model based on some input data.
To do this we compute the SVD of the data, rotate into its sigular space,
and then compute the spectrum of each rotated detector.
These spectra are then smoothed and a filter a made by squaring and
inverting the smoothed filter.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to estimate the white noise levels from.
Should be a 2d array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>noise_model</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="NoiseSmoothedSVD


  
      dataclass
   (jitkasi.noise.NoiseSmoothedSVD)" href="#jitkasi.noise.NoiseSmoothedSVD">NoiseSmoothedSVD</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of NoiseSmoothedSVD with the computed noise model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute this noise model based on some input data.</span>
<span class="sd">    To do this we compute the SVD of the data, rotate into its sigular space,</span>
<span class="sd">    and then compute the spectrum of each rotated detector.</span>
<span class="sd">    These spectra are then smoothed and a filter a made by squaring and</span>
<span class="sd">    inverting the smoothed filter.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The data to estimate the white noise levels from.</span>
<span class="sd">        Should be a 2d array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    noise_model : NoiseSmoothedSVD</span>
<span class="sd">        An instance of NoiseSmoothedSVD with the computed noise model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">T</span>
    <span class="n">dat_rot</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dat</span><span class="p">)</span>
    <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">jm</span><span class="o">.</span><span class="n">dct_i</span><span class="p">(</span><span class="n">dat_rot</span><span class="p">)</span>
    <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">dat_ft</span><span class="o">.</span><span class="n">at</span><span class="p">[:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">jm</span><span class="o">.</span><span class="n">gauss_smooth_1d</span><span class="p">(</span><span class="n">dat_ft</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">fwhm</span><span class="p">))</span>
    <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">dat_ft</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">dat_ft</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:])</span>
    <span class="n">dat_ft</span> <span class="o">=</span> <span class="n">dat_ft</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dat_ft</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="jitkasi.noise.NoiseWhite" class="doc doc-heading">
            <code>NoiseWhite</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>A simple noise model with only white noise.
This is equivalent to a diagonal <span class="arithmatex">\(N^{-1}\)</span>.
This class is a registered pytree so it is JITable with JAX.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="jitkasi.noise.NoiseWhite.weights">weights</span></code></td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The per-detector weights conputed from the white noise.
This is a child of the pytree.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>jitkasi/noise.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_pytree_node_class</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoiseWhite</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A simple noise model with only white noise.</span>
<span class="sd">    This is equivalent to a diagonal $N^{-1}$.</span>
<span class="sd">    This class is a registered pytree so it is JITable with JAX.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    weights: Array</span>
<span class="sd">        The per-detector weights conputed from the white noise.</span>
<span class="sd">        This is a child of the pytree.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">weights</span><span class="p">:</span> <span class="n">Array</span>

    <span class="nd">@jit</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the noise model.</span>
<span class="sd">        In this case this is just rescaling each detector by its weight.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The data to apply the noise model to.</span>
<span class="sd">            Should be 2d with `dat.shape[0] == len(self.weights)`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dat_filt : Array</span>
<span class="sd">            The data with the noise model applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute this noise model based on some input data.</span>
<span class="sd">        Here we just estimate the variance of each detector in dat.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The data to estimate the white noise levels from.</span>
<span class="sd">            Should be a 2d array.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        noise_model : NoiseWhite</span>
<span class="sd">            An instance of NoiseWhite with the computed noise model.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">2</span> <span class="o">*</span> <span class="n">erfinv</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>

    <span class="c1"># Functions for making this a pytree</span>
    <span class="c1"># Don&#39;t call this on your own</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="n">children</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,)</span>
        <span class="n">aux_data</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_unflatten</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">children</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">aux_data</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">children</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseWhite.apply_noise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_noise</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply the noise model.
In this case this is just rescaling each detector by its weight.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to apply the noise model to.
Should be 2d with <code>dat.shape[0] == len(self.weights)</code>.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dat_filt</code></td>            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data with the noise model applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the noise model.</span>
<span class="sd">    In this case this is just rescaling each detector by its weight.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The data to apply the noise model to.</span>
<span class="sd">        Should be 2d with `dat.shape[0] == len(self.weights)`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dat_filt : Array</span>
<span class="sd">        The data with the noise model applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseWhite.compute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Compute this noise model based on some input data.
Here we just estimate the variance of each detector in dat.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to estimate the white noise levels from.
Should be a 2d array.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>noise_model</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="NoiseWhite


  
      dataclass
   (jitkasi.noise.NoiseWhite)" href="#jitkasi.noise.NoiseWhite">NoiseWhite</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of NoiseWhite with the computed noise model.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@partial</span><span class="p">(</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnums</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,))</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute this noise model based on some input data.</span>
<span class="sd">    Here we just estimate the variance of each detector in dat.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The data to estimate the white noise levels from.</span>
<span class="sd">        Should be a 2d array.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    noise_model : NoiseWhite</span>
<span class="sd">        An instance of NoiseWhite with the computed noise model.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">2</span> <span class="o">*</span> <span class="n">erfinv</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="jitkasi.noise.NoiseWrapper" class="doc doc-heading">
            <code>NoiseWrapper</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Wrapper to use external noise models in <code>jitkasi</code>.</p>
<p>Be warned that while this is provided we cannot gaurentee that the external class
will play nicely with the rest of the library.
In particular while the wrapper for <code>apply_noise</code> is set up to be called from a jitted function,
<code>compute</code> is not since it includes some non-pure actions.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="jitkasi.noise.NoiseWrapper.ext_inst">ext_inst</span></code></td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The instance of the external noise model class we are wrapping.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jitkasi.noise.NoiseWrapper.apply_func">apply_func</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the function in <code>ext_inst</code> that applies noise.
We expect this to take a single 2d array as an argument.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jitkasi.noise.NoiseWrapper.jitted">jitted</span></code></td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the external noise class JITs its functions.
If this is False you should be very caruful about how you use this class.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="jitkasi.noise.NoiseWrapper.shape_dtypes">shape_dtypes</span></code></td>
            <td>
                  <code><span title="jax.ShapeDtypeStruct">ShapeDtypeStruct</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The shape and dtype of the array that the <code>apply_func</code> expects.
This is really only used so what we can call <code>apply_func</code> when we aren't jitted.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>







              <details class="quote">
                <summary>Source code in <code>jitkasi/noise.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_pytree_node_class</span>
<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoiseWrapper</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper to use external noise models in `jitkasi`.</span>

<span class="sd">    Be warned that while this is provided we cannot gaurentee that the external class</span>
<span class="sd">    will play nicely with the rest of the library.</span>
<span class="sd">    In particular while the wrapper for `apply_noise` is set up to be called from a jitted function,</span>
<span class="sd">    `compute` is not since it includes some non-pure actions.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    ext_inst : Callable</span>
<span class="sd">        The instance of the external noise model class we are wrapping.</span>
<span class="sd">    apply_func : str</span>
<span class="sd">        The name of the function in `ext_inst` that applies noise.</span>
<span class="sd">        We expect this to take a single 2d array as an argument.</span>
<span class="sd">    jitted : bool</span>
<span class="sd">        Whether or not the external noise class JITs its functions.</span>
<span class="sd">        If this is False you should be very caruful about how you use this class.</span>
<span class="sd">    shape_dtypes : ShapeDtypeStruct</span>
<span class="sd">        The shape and dtype of the array that the `apply_func` expects.</span>
<span class="sd">        This is really only used so what we can call `apply_func` when we aren&#39;t jitted.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ext_inst</span><span class="p">:</span> <span class="n">Callable</span>
    <span class="n">apply_func</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">jitted</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">shape_dtypes</span><span class="p">:</span> <span class="n">ShapeDtypeStruct</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">jitted</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Initialized a non-JIT noise class! This is not supported in all usecases, proceed with caution.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply the external noise model.</span>
<span class="sd">        This should be safe to call from jitted functions.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The data to apply the noise model to.</span>
<span class="sd">            Should have shape and dtype that matches the `shape_dtypes` attribute.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dat_filt : Array</span>
<span class="sd">            The data with the noise model applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jitted</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_inst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">)(</span><span class="n">dat</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pure_callback</span><span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_inst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_dtypes</span><span class="p">,</span> <span class="n">dat</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
        <span class="n">ext_class</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
        <span class="n">compute_func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">apply_func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">jitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make an instance of the external noise class and make an instance of this class to wrap it.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dat : Array</span>
<span class="sd">            The data to compute the noise model with.</span>
<span class="sd">        ext_class : Callable</span>
<span class="sd">            The external noise model class.</span>
<span class="sd">            Must have a class method (`__call__` is acceptable) that will create an instance</span>
<span class="sd">            and compute the noise model.</span>
<span class="sd">        compute_func : str</span>
<span class="sd">            The function that computes an instance of the external noise model.</span>
<span class="sd">            Should take `dat` as its first argument.</span>
<span class="sd">        apply_func : str</span>
<span class="sd">            The function that applies the noise model to some data.</span>
<span class="sd">        jitted : str</span>
<span class="sd">            Whether or not the external noise class JITs its own functions.</span>
<span class="sd">        *args</span>
<span class="sd">            Additional arguments to pass to `compute_func`.</span>
<span class="sd">        **kwargs</span>
<span class="sd">            Additional keyword arguments to pass to `compute_func`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        noise_model : NoiseWrapper</span>
<span class="sd">            An instance of `NoiseWrapper` that wraps an instance of `ext_class`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">shape_dtypes</span> <span class="o">=</span> <span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">dat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dat</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Array</span> <span class="o">|</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">dat</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">jitted</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
        <span class="n">inst</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ext_class</span><span class="p">,</span> <span class="n">compute_func</span><span class="p">)(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">apply_func</span><span class="p">,</span> <span class="n">jitted</span><span class="p">,</span> <span class="n">shape_dtypes</span><span class="p">)</span>

    <span class="c1"># Functions for making this a pytree</span>
    <span class="c1"># Don&#39;t call this on your own</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_flatten</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]:</span>
        <span class="n">children</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">aux_data</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_inst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">jitted</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_dtypes</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">children</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tree_unflatten</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">,</span> <span class="n">children</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
        <span class="k">del</span> <span class="n">children</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="o">*</span><span class="n">aux_data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseWrapper.apply_noise" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_noise</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Apply the external noise model.
This should be safe to call from jitted functions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to apply the noise model to.
Should have shape and dtype that matches the <code>shape_dtypes</code> attribute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dat_filt</code></td>            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data with the noise model applied.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">apply_noise</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply the external noise model.</span>
<span class="sd">    This should be safe to call from jitted functions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The data to apply the noise model to.</span>
<span class="sd">        Should have shape and dtype that matches the `shape_dtypes` attribute.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dat_filt : Array</span>
<span class="sd">        The data with the noise model applied.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">jitted</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_inst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">)(</span><span class="n">dat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pure_callback</span><span class="p">(</span>
        <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ext_inst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_func</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_dtypes</span><span class="p">,</span> <span class="n">dat</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="jitkasi.noise.NoiseWrapper.compute" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compute</span><span class="p">(</span><span class="n">dat</span><span class="p">,</span> <span class="n">ext_class</span><span class="p">,</span> <span class="n">compute_func</span><span class="p">,</span> <span class="n">apply_func</span><span class="p">,</span> <span class="n">jitted</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Make an instance of the external noise class and make an instance of this class to wrap it.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dat</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The data to compute the noise model with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ext_class</code>
            </td>
            <td>
                  <code><span title="typing.Callable">Callable</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The external noise model class.
Must have a class method (<code>__call__</code> is acceptable) that will create an instance
and compute the noise model.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>compute_func</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function that computes an instance of the external noise model.
Should take <code>dat</code> as its first argument.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>apply_func</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The function that applies the noise model to some data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>jitted</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether or not the external noise class JITs its own functions.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>*args</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments to pass to <code>compute_func</code>.</p>
              </div>
            </td>
            <td>
                  <code>()</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to <code>compute_func</code>.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>noise_model</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="NoiseWrapper


  
      dataclass
   (jitkasi.noise.NoiseWrapper)" href="#jitkasi.noise.NoiseWrapper">NoiseWrapper</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An instance of <code>NoiseWrapper</code> that wraps an instance of <code>ext_class</code>.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>jitkasi/noise.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compute</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">dat</span><span class="p">:</span> <span class="n">Array</span><span class="p">,</span>
    <span class="n">ext_class</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">compute_func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">apply_func</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">jitted</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="o">*</span><span class="n">args</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Self</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make an instance of the external noise class and make an instance of this class to wrap it.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dat : Array</span>
<span class="sd">        The data to compute the noise model with.</span>
<span class="sd">    ext_class : Callable</span>
<span class="sd">        The external noise model class.</span>
<span class="sd">        Must have a class method (`__call__` is acceptable) that will create an instance</span>
<span class="sd">        and compute the noise model.</span>
<span class="sd">    compute_func : str</span>
<span class="sd">        The function that computes an instance of the external noise model.</span>
<span class="sd">        Should take `dat` as its first argument.</span>
<span class="sd">    apply_func : str</span>
<span class="sd">        The function that applies the noise model to some data.</span>
<span class="sd">    jitted : str</span>
<span class="sd">        Whether or not the external noise class JITs its own functions.</span>
<span class="sd">    *args</span>
<span class="sd">        Additional arguments to pass to `compute_func`.</span>
<span class="sd">    **kwargs</span>
<span class="sd">        Additional keyword arguments to pass to `compute_func`.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    noise_model : NoiseWrapper</span>
<span class="sd">        An instance of `NoiseWrapper` that wraps an instance of `ext_class`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">shape_dtypes</span> <span class="o">=</span> <span class="n">ShapeDtypeStruct</span><span class="p">(</span><span class="n">dat</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dat</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Array</span> <span class="o">|</span> <span class="n">NDArray</span> <span class="o">=</span> <span class="n">dat</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">jitted</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dat</span><span class="p">)</span>
    <span class="n">inst</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ext_class</span><span class="p">,</span> <span class="n">compute_func</span><span class="p">)(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">inst</span><span class="p">,</span> <span class="n">apply_func</span><span class="p">,</span> <span class="n">jitted</span><span class="p">,</span> <span class="n">shape_dtypes</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>